{"version":3,"sources":["assets\\Scripts\\BackgroundManager.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA+C,qCAAY;IAA3D;QAAA,qEA+CC;QA9CoB,oBAAc,GAAW,eAAe,CAAC;QAGlD,eAAS,GAAY,IAAI,CAAC;QAG1B,aAAO,GAAY,IAAI,CAAC;QAGxB,kBAAY,GAAW,CAAC,CAAC;QAGzB,oBAAc,GAAW,GAAG,CAAC;;IAkCzC,CAAC;IAhCa,kCAAM,GAAhB;QACI,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;IACvE,CAAC;IAES,qCAAS,GAAnB;QACI,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;IACxE,CAAC;IAEM,2CAAe,GAAtB,UAAuB,QAAgB;QACnC,IAAM,YAAY,GAAG,CAAC,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC;QAErD,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC;aACnB,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,QAAQ,EAAE,EAAE,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;aACpF,KAAK,EAAE,CAAC;QAEb,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC;aACjB,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,QAAQ,EAAE,EAAE,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;aACpF,KAAK,EAAE,CAAC;QAGb,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IAC7D,CAAC;IAEO,iDAAqB,GAA7B,UAA8B,KAAc,EAAE,GAAY;QACtD,IAAI,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;YACzB,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC;SAC/B;QAED,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE;YACrB,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC;SACjC;IACL,CAAC;IA1CD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;wDACgB;IAGlC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;sDACc;IAGhC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;2DACc;IAGjC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6DACkB;IAbpB,iBAAiB;QADrC,OAAO;OACa,iBAAiB,CA+CrC;IAAD,wBAAC;CA/CD,AA+CC,CA/C8C,EAAE,CAAC,SAAS,GA+C1D;kBA/CoB,iBAAiB","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class BackgroundManager extends cc.Component {\r\n    private readonly PLAYER_REACHED: string = 'playerReached';\r\n\r\n    @property(cc.Node)\r\n    private firstBack: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private endBack: cc.Node = null;\r\n\r\n    @property(cc.Float)\r\n    private moveDuration: number = 1;\r\n\r\n    @property(cc.Float)\r\n    private parallaxFactor: number = 0.5;\r\n\r\n    protected onLoad() {\r\n        cc.systemEvent.on(this.PLAYER_REACHED, this.onPlayerReached, this);\r\n    }\r\n\r\n    protected onDestroy() {\r\n        cc.systemEvent.off(this.PLAYER_REACHED, this.onPlayerReached, this);\r\n    }\r\n\r\n    public onPlayerReached(distance: number) {\r\n        const moveDistance = -distance * this.parallaxFactor;\r\n\r\n        cc.tween(this.firstBack)\r\n            .by(this.moveDuration, { position: cc.v3(moveDistance, 0) }, { easing: 'sineInOut' })\r\n            .start();\r\n\r\n        cc.tween(this.endBack)\r\n            .by(this.moveDuration, { position: cc.v3(moveDistance, 0) }, { easing: 'sineInOut' })\r\n            .start();\r\n\r\n\r\n        this.checkAndResetPosition(this.firstBack, this.endBack);\r\n    }\r\n\r\n    private checkAndResetPosition(first: cc.Node, end: cc.Node) {\r\n        if (first.x <= -first.width) {\r\n            first.x = end.x + end.width;\r\n        }\r\n\r\n        if (end.x <= -end.width) {\r\n            end.x = first.x + first.width;\r\n        }\r\n    }\r\n}\r\n"]}