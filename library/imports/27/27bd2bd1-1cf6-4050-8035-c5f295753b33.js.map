{"version":3,"sources":["assets\\Scripts\\BackgroundManager.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA+C,qCAAY;IAA3D;QAAA,qEAkDC;QAjDoB,oBAAc,GAAW,eAAe,CAAC;QAGlD,eAAS,GAAY,IAAI,CAAC;QAG1B,aAAO,GAAY,IAAI,CAAC;QAGxB,kBAAY,GAAW,CAAC,CAAC;QAGzB,oBAAc,GAAW,GAAG,CAAC;;IAqCzC,CAAC;IAnCa,kCAAM,GAAhB;QACI,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;IACvE,CAAC;IAES,qCAAS,GAAnB;QACI,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;IACxE,CAAC;IAEM,2CAAe,GAAtB,UAAuB,QAAgB;QACnC,IAAM,YAAY,GAAG,CAAC,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC;QAErD,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC;aACnB,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,QAAQ,EAAE,EAAE,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;aACpF,KAAK,EAAE,CAAC;QAEb,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC;aACjB,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,QAAQ,EAAE,EAAE,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;aACpF,KAAK,EAAE,CAAC;QAEb,4BAA4B;QAC5B,gEAAgE;QAChE,yBAAyB;QAEzB,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IAC7D,CAAC;IAEO,iDAAqB,GAA7B,UAA8B,KAAc,EAAE,GAAY;QACtD,IAAI,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;YACzB,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC;SAC/B;QAED,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE;YACrB,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC;SACjC;IACL,CAAC;IA7CD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;wDACgB;IAGlC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;sDACc;IAGhC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;2DACc;IAGjC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6DACkB;IAbpB,iBAAiB;QADrC,OAAO;OACa,iBAAiB,CAkDrC;IAAD,wBAAC;CAlDD,AAkDC,CAlD8C,EAAE,CAAC,SAAS,GAkD1D;kBAlDoB,iBAAiB","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class BackgroundManager extends cc.Component {\n    private readonly PLAYER_REACHED: string = 'playerReached';\n\n    @property(cc.Node)\n    private firstBack: cc.Node = null;\n\n    @property(cc.Node)\n    private endBack: cc.Node = null;\n\n    @property(cc.Float)\n    private moveDuration: number = 1;\n\n    @property(cc.Float)\n    private parallaxFactor: number = 0.5;\n\n    protected onLoad() {\n        cc.systemEvent.on(this.PLAYER_REACHED, this.onPlayerReached, this);\n    }\n\n    protected onDestroy() {\n        cc.systemEvent.off(this.PLAYER_REACHED, this.onPlayerReached, this);\n    }\n\n    public onPlayerReached(distance: number) {\n        const moveDistance = -distance * this.parallaxFactor;\n\n        cc.tween(this.firstBack)\n            .by(this.moveDuration, { position: cc.v3(moveDistance, 0) }, { easing: 'sineInOut' })\n            .start();\n\n        cc.tween(this.endBack)\n            .by(this.moveDuration, { position: cc.v3(moveDistance, 0) }, { easing: 'sineInOut' })\n            .start();\n\n        // this.scheduleOnce(() => {\n        //     this.checkAndResetPosition(this.firstBack, this.endBack);\n        // }, this.moveDuration);\n\n        this.checkAndResetPosition(this.firstBack, this.endBack);\n    }\n\n    private checkAndResetPosition(first: cc.Node, end: cc.Node) {\n        if (first.x <= -first.width) {\n            first.x = end.x + end.width;\n        }\n\n        if (end.x <= -end.width) {\n            end.x = first.x + first.width;\n        }\n    }\n}\n"]}