{"version":3,"sources":["assets\\Scripts\\UI\\GameWindow.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Window from \"./Window\";\r\nimport Label = cc.Label;\r\nimport DataCounter from \"../DataCounter\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameWindow extends Window {\r\n    private readonly DOUBLE: string = 'double';\r\n    private readonly PLAYER_REACHED: string = 'playerReached';\r\n    private readonly PLAYER_FALL: string = 'playerFall';\r\n\r\n    @property(Label)\r\n    private counter: Label = null;\r\n\r\n    @property(Number)\r\n    private scaleDuration: number = 0.5;\r\n\r\n    @property(Number)\r\n    private increase: number = 1.5;\r\n\r\n    private originalScale: number = 0;\r\n    private count: number = 0;\r\n    private point: number = 0;\r\n\r\n    get isPopUp(): boolean {\r\n        return false;\r\n    }\r\n\r\n    protected onEnable() {\r\n        cc.systemEvent.on(this.PLAYER_REACHED, this.onPlayerReached, this);\r\n        cc.systemEvent.on(this.DOUBLE, this.onDouble, this);\r\n        cc.systemEvent.on(this.PLAYER_FALL, this.onDouble, this);\r\n    }\r\n\r\n    protected onDisable() {\r\n        cc.systemEvent.off(this.PLAYER_REACHED, this.onPlayerReached, this);\r\n        cc.systemEvent.off(this.DOUBLE, this.onDouble, this);\r\n        cc.systemEvent.off(this.PLAYER_FALL, this.onPlayerFall, this);\r\n    }\r\n\r\n    protected start() {\r\n        this.originalScale = this.counter.node.scale;\r\n    }\r\n\r\n    public show() {\r\n        super.show();\r\n        this.resetCounter();\r\n    }\r\n\r\n    private resetCounter() {\r\n        this.count = 0;\r\n        this.updateCounterDisplay();\r\n    }\r\n\r\n    private onDouble() {\r\n        this.point++;\r\n\r\n        DataCounter.setDoubleCount(DataCounter.getDoubleCount() + 1);\r\n    }\r\n\r\n    private onPlayerReached() {\r\n        this.point++;\r\n\r\n        this.count += this.point;\r\n        this.updateCounterDisplay();\r\n        this.animateCounter();\r\n\r\n        this.point = 0;\r\n    }\r\n\r\n    private onPlayerFall(){\r\n        DataCounter.setScore(this.count);\r\n\r\n        if (DataCounter.getBestScore() < this.count) {\r\n            DataCounter.setBestScore(this.count);\r\n        }\r\n    }\r\n\r\n    private updateCounterDisplay() {\r\n        this.counter.string = this.count.toString();\r\n    }\r\n\r\n    private animateCounter() {\r\n        cc.Tween.stopAllByTarget(this.counter.node);\r\n\r\n        cc.tween(this.counter.node)\r\n            .to(this.scaleDuration, { scale: this.originalScale * this.increase })\r\n            .to(this.scaleDuration, { scale: this.originalScale })\r\n            .start();\r\n    }\r\n}\r\n"]}